{{define "body"}}
<section class="upload">
  <form action="/upload" method="POST" enctype="multipart/form-data" id="uploadForm" autocomplete="off">
    <table>
      <tr class="form-group">
        <td><label for="subject">Subject</label></td>
        <td><input type="text" id="subject" name="subject" autocomplete="off" maxlength="100" /></td>
      </tr>
      <tr class="form-group">
        <td><label for="message">Message</label></td>
        <td>
          <textarea id="message" name="message" rows="4" maxlength="1500" autocomplete="off"></textarea>
        </td>
      </tr>
      <tr class="form-group">
        <td><label for="imageFile">Select File</label></td>
        <td>
          <div class="file-input-wrapper">
            <input type="file" id="imageFile" name="imageFile" accept="image/png,image/jpeg,image/webp" autocomplete="off" required />
          </div>
        </td>
      </tr>
      <tr>
        <td></td>
        <td>
          <button type="submit">Post</button>
        </td>
      </tr>
    </table>
  </form>
</section>
<section class="gallery">
  {{range .}}
  <article class="gallery__item">
    <div class="post-content">
      {{if .Image}}
      <div class="post-image">
        <div class="file-info">
          <a href="/img/{{.Image.ID}}">{{.Image.ShortID}}.{{.Image.Extension}}</a>
          <span>- {{.Image.FormattedSize}} {{.Image.Width}}x{{.Image.Height}}</span>
        </div>
        <a href="/img/{{.Image.ID}}" class="file-image">
          <img
            src="/img/{{.Image.ID}}_600"
            srcset="/img/{{.Image.ID}}_600 600w, /img/{{.Image.ID}}_800 800w, /img/{{.Image.ID}}_1200 1200w, /img/{{.Image.ID}}_1600 1600w"
            sizes="(max-width: 480px) 90vw, (max-width: 768px) 45vw, 300px"
            loading="lazy"
            alt="Image {{.Image.ID}}"
          />
        </a>
      </div>
      {{end}}

      <div class="post-header">
        {{if .Post.Subject}}
        <span class="post-subject">{{.Post.Subject}}</span>&nbsp;&nbsp; {{end}}
        <span class="post-name">{{if .Post.Name}}{{.Post.Name}}{{else}}Anonymous{{end}}</span>&nbsp;
        <span class="post-date">{{if .Image}}{{.Image.FormattedTime}}{{else}}{{.Post.FormattedTime}}{{end}}</span>
      </div>

      {{if .Post.Message}} {{if .Post.NeedsExpand}}
      <input type="checkbox" id="expand-{{.Post.ID}}" class="message-toggle" />
      <div class="post-message post-message--preview">{{.Post.TruncatedMessage}}...</div>
      <div class="post-message post-message--full">{{.Post.Message}}</div>
      <label for="expand-{{.Post.ID}}" class="view-more">View all</label>
      {{else}}
      <div class="post-message">{{.Post.Message}}</div>
      {{end}} {{end}}
    </div>
  </article>
  {{else}}
  <p>No images available.</p>
  {{end}}
</section>

{{end}}
